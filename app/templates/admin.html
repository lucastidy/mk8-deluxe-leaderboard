
{% extends "base.html" %}
{% block content %}
  <h1>Pending Submissions</h1>

  {% if not pending %}
    <p>No pending submissions.</p>
  {% endif %}

  <ul class="pending-list">
    {% for e in pending %}
      <li class="pending-item">
        <div>
          <strong>User:</strong> {{ e.user.username }} &nbsp;
          <strong>Track:</strong> {{ e.track }} &nbsp;
          <strong>Time:</strong> {{ e.time_mins }}:{{ "%02d"|format(e.time_s) }}.{{ "%03d"|format(e.time_ms) }}
        </div>

        <div class="screenshot-preview">
          {% if e.screenshot_path %}
            {% if e.screenshot_path.startswith('http') %}
              <a href="{{ e.screenshot_path }}" target="_blank">
                <img src="{{ e.screenshot_path }}" style="max-width:300px; max-height:200px;" />
              </a>
            {% else %}
              <!-- local: use url_for('static', filename=xyz) -->
              {% set fname = e.screenshot_path.split('/static/', 1)[-1] %}
              <a href="{{ url_for('static', filename=fname) }}" target="_blank">
                <img src="{{ url_for('static', filename=fname) }}" style="max-width:300px; max-height:200px;" />
              </a>
            {% endif %}
          {% else %}
            <em>No screenshot path</em>
          {% endif %}
        </div>

        <div class="admin-actions">
          <form action="{{ url_for('admin_verify', entry_id=e.id) }}" method="post" style="display:inline;">
            <button type="submit" class="btn btn-success">Approve</button>
          </form>

          <form action="{{ url_for('admin_reject', entry_id=e.id) }}" method="post" style="display:inline;" onsubmit="return confirm('Delete this submission?');">
            <button type="submit" class="btn btn-danger">Reject</button>
          </form>
        </div>
      </li>
      <hr/>
    {% endfor %}
  </ul>
{% endblock %}
